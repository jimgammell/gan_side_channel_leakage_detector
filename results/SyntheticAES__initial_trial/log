(main) Running trial specified in SyntheticAES__initial_trial ...
(main) Parsing settings file at ../config/SyntheticAES__initial_trial.json ...
(main) 	Using default settings at ../config/SyntheticAES__default.json.
(main) 	dataset_constructor: <class 'datasets.synthetic_aes.SyntheticAES'>
(main) 	dataset_kwargs: {'num_traces': 10000, 'measurements_per_trace': 128, 'leaking_positions': None, 'leaking_measurements_1o': 1, 'leaking_measurements_ho': 0, 'fixed_profile_stdev': 1.0, 'random_noise_stdev': 0.5, 'hamming_weight_variance_props': 0.5, 'ref_vals': 0, 'maximum_delay': 0, 'transform': None, 'target_transform': None, 'rng': None}
(main) 	val_split_prop: 0.2
(main) 	dataloader_kwargs: {'batch_size': 256, 'num_workers': 1, 'pin_memory': True}
(main) 	classifier_constructor: <class 'models.cnn.CNNClassifier'>
(main) 	classifier_kwargs: {'kernel_size': 11, 'cnn_kernels': [16, 32, 64], 'mlp_layer_sizes': [64, 64]}
(main) 	classifier_optimizer_constructor: <class 'torch.optim.adam.Adam'>
(main) 	classifier_optimizer_kwargs: {'lr': 0.001}
(main) 	classifier_scheduler_constructor: None
(main) 	classifier_scheduler_kwargs: {}
(main) 	classifier_use_sam: True
(main) 	classifier_sam_kwargs: {'rho': 0.05, 'adaptive': False}
(main) 	classifier_es_metric: rank
(main) 	maximize_classifier_es_metric: False
(main) 	mask_constructor: <class 'models.mask.FixedMask'>
(main) 	mask_kwargs: {}
(main) 	mask_optimizer_constructor: <class 'torch.optim.adam.Adam'>
(main) 	mask_optimizer_kwargs: {'lr': 0.001}
(main) 	mask_l1_decay: 10.0
(main) 	mask_es_metric: mean_ratio
(main) 	maximize_mask_es_metric: True
(main) 	num_training_steps: 5000
(main) 	num_val_measurements: 100
(main) 	eps: 1e-12
(main) 	Base results directory: ../results/SyntheticAES__initial_trial
(main) 	Results directory: ../results/SyntheticAES__initial_trial/results
(main) 	Figure directory: ../results/SyntheticAES__initial_trial/figures
(main) 	Model directory: ../results/SyntheticAES__initial_trial/models
(main) 	Base directory already exists; deleting it ...
(leakage_detectors/eval_leakage_detectors) Constructing dataset ...
(leakage_detectors/eval_leakage_detectors) 	Done in 0.46033382415771484 sec.
(leakage_detectors/eval_leakage_detectors) <datasets.synthetic_aes.SyntheticAES object at 0x7fb26c44dd60>
(leakage_detectors/eval_leakage_detectors) Computing per-target trace means ...
(leakage_detectors/eval_leakage_detectors) 	Done in 0.026548147201538086 sec.
(leakage_detectors/eval_leakage_detectors) Computing sum of differences ...
(leakage_detectors/eval_leakage_detectors) 	Done in 0.0001220703125 sec.
(leakage_detectors/eval_leakage_detectors) Computing signal-noise ratio ...
(leakage_detectors/eval_leakage_detectors) 	Done in 0.015809297561645508 sec.
(leakage_detectors/eval_leakage_detectors) Constructing validation split and dataloaders ...
(leakage_detectors/eval_leakage_detectors) 	Done in 0.0008609294891357422 sec.
(leakage_detectors/eval_leakage_detectors) Constructing a classifier for the attribution-based methods ...
(leakage_detectors/eval_leakage_detectors) 	Done in 0.9421439170837402 sec.
(leakage_detectors/eval_leakage_detectors) CNNClassifier(
  input_shape:     (1, 128)
  output_classes:  9
  kernel_size:     11
  cnn_kernels:     [16, 32, 64]
  mlp_layer_sizes: [64, 64]
  (feature_extractor): Sequential(
    (0): Conv1d(1, 16, kernel_size=(11,), stride=(1,), padding=(5,), bias=False)
    (1): BatchNorm1d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): SELU()
    (3): AvgPool1d(kernel_size=(2,), stride=(2,), padding=(0,))
    (4): Conv1d(16, 32, kernel_size=(11,), stride=(1,), padding=(5,), bias=False)
    (5): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): SELU()
    (7): AvgPool1d(kernel_size=(2,), stride=(2,), padding=(0,))
    (8): Conv1d(32, 64, kernel_size=(11,), stride=(1,), padding=(5,), bias=False)
    (9): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (10): SELU()
  )
  (mlp_classifier): Sequential(
    (0): Linear(in_features=64, out_features=64, bias=True)
    (1): SELU()
    (2): Linear(in_features=64, out_features=64, bias=True)
    (3): SELU()
    (4): Linear(in_features=64, out_features=9, bias=True)
  )
)
(leakage_detectors/eval_leakage_detectors) Training the classifier with supervised learning ...
(leakage_detectors/eval_leakage_detectors) 	Done in 65.1205575466156 sec.
(leakage_detectors/eval_leakage_detectors) Computing saliency map on the training dataset ...
(leakage_detectors/eval_leakage_detectors) 	Done in 0.17239713668823242 sec.
(leakage_detectors/eval_leakage_detectors) Computing saliency map on the validation dataset ...
(leakage_detectors/eval_leakage_detectors) 	Done in 0.08672809600830078 sec.
(leakage_detectors/eval_leakage_detectors) Constructing a classifier for adversarial masking methods ...
(leakage_detectors/eval_leakage_detectors) 	Done in 0.0022029876708984375 sec.
(leakage_detectors/eval_leakage_detectors) CNNClassifier(
  input_shape:     (1, 128)
  output_classes:  9
  kernel_size:     11
  cnn_kernels:     [16, 32, 64]
  mlp_layer_sizes: [64, 64]
  (feature_extractor): Sequential(
    (0): Conv1d(1, 16, kernel_size=(11,), stride=(1,), padding=(5,), bias=False)
    (1): BatchNorm1d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): SELU()
    (3): AvgPool1d(kernel_size=(2,), stride=(2,), padding=(0,))
    (4): Conv1d(16, 32, kernel_size=(11,), stride=(1,), padding=(5,), bias=False)
    (5): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): SELU()
    (7): AvgPool1d(kernel_size=(2,), stride=(2,), padding=(0,))
    (8): Conv1d(32, 64, kernel_size=(11,), stride=(1,), padding=(5,), bias=False)
    (9): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (10): SELU()
  )
  (mlp_classifier): Sequential(
    (0): Linear(in_features=64, out_features=64, bias=True)
    (1): SELU()
    (2): Linear(in_features=64, out_features=64, bias=True)
    (3): SELU()
    (4): Linear(in_features=64, out_features=9, bias=True)
  )
)
(leakage_detectors/eval_leakage_detectors) Constructing a masking model for adversarial masking methods ...
(leakage_detectors/eval_leakage_detectors) 	Done in 0.00013375282287597656 sec.
(leakage_detectors/eval_leakage_detectors) FixedMask(	input_shape: (1, 128))
(leakage_detectors/eval_leakage_detectors) Running the adversarial training loop ...
(leakage_detectors/eval_leakage_detectors) 	Done in 90.32400584220886 sec.
